stages:
- build
- publish

before_script:
- npm install

build:
  stage: build
  image: node:8
  only:
  - master
  - develop
  script:
  - npm run build

publish:
  stage: publish
  image: node:8
  only:
  - tags
  script:
  - npm run build
  - echo "//registry.npmjs.org/:_authToken=$NPM_TOKEN" > ~/.npmrc
  - npm version ${CI_COMMIT_TAG}
  - npm publish

